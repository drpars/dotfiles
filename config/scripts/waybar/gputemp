#!/bin/bash

gpumode=$(supergfxctl -g)
internalgpu=$(sensors -A amdgpu-pci-0600 | awk '/째C/ {print $2}' | cut -c2-3)
externalgpu=$(nvidia-smi --query-gpu=temperature.gpu --format=csv,noheader,nounits)

if echo $gpumode | grep -q "Hybrid"; then 
  echo "{\"text\":\"I-GPU $internalgpu째C      E-GPU $externalgpu째C\", \"tooltip\":\"Hybrid\"}"
elif echo $gpumode | grep -q "Integrated";  then
  echo "{\"text\":\"GPU $internalgpu째C\", \"tooltip\":\"Integrated\"}"
elif echo $gpumode | grep -q "Vfio" ; then
  echo "{\"text\":\"Vfio\", \"tooltip\":\"Vfio\"}"
fi
